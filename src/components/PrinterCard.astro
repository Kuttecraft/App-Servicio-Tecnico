---
const {
  id,
  ticket = "Sin ticket",
  cliente = "Desconocido",
  maquina = "Desconocido",
  estado = "Sin estado",
  whatsapp = "No especificado",
  onClickUrl = "#",
  onClickUrlEditar = "#",
  imagen = null,         // Imagen principal
  imagen_ticket = null,  // Nueva imagen_ticket
  imagen_extra = null    // Nueva imagen_extra
} = Astro.props;

// L칩gica de prioridad de im치genes:
// 1. imagen_ticket
// 2. imagen
// 3. imagen_extra
// 4. logo por defecto
const imagenFinal =
  imagen_ticket ||
  imagen ||
  imagen_extra ||
  "/logo.webp";

// 游꿛 Mapa de colores pastel SUAVES (punto medio-bajo de saturaci칩n)
const estadoColores = {
  "Retirar": "#FFE9CC",           // Naranja suave claro
  "Presupuestar": "#FFD9D9",      // Rojo suave claro
  "Enviar presupuesto": "#E9FCEC",// Verde menta suave claro
  "P. Enviado": "#D9EBFF",        // Azul cielo suave claro
  "Reparaci칩n": "#FFFDE1",        // Amarillo suave claro
  "Prueba": "#E3DBFF",            // Lila suave claro
  "Lista": "#FFE3DC",             // Durazno suave claro
  "Entregada": "#E6F6FF",         // Celeste hielo suave
  "Feedback Enviado": "#FAE4F6",  // Rosa-lila suave claro
  "Archivada": "#EDEDED",         // Gris claro
  "No realizada": "#FFF1D9"       // Amarillo crema suave
};

// Color actual o blanco si no est치 en el mapa
const colorEstado = estadoColores[estado] || "#FFFFFF";
---

<style>
  /* Card de altura uniforme */
  .pcard {
    display: flex;
    flex-direction: column;
    border-radius: 15px;
    min-width: 220px;
    transition: transform 0.15s ease;
    border: 1px solid rgba(0,0,0,.06); /* contorno sutil */
  }

  /* Peque침a animaci칩n al pasar el mouse */
  .pcard:hover {
    transform: translateY(-3px);
  }

  /* Contenedor cuadrado para la imagen */
  .pcard__imgwrap {
    width: 200px;              /* controla el tama침o final */
    aspect-ratio: 1 / 1;       /* siempre cuadrado */
    border-radius: 15px;
    overflow: hidden;
    margin: .25rem auto  .5rem auto; /* centrado */
    box-shadow: 0 2px 8px rgba(0,0,0,.08);
    border: 1px solid rgba(0,0,0,.06);
    background: #f5f6f8;       /* placeholder si tarda en cargar */
  }

  .pcard__img {
    width: 100%;
    height: 100%;
    object-fit: cover;         /* recorta para llenar sin deformar */
    display: block;
  }

  .pcard__body {               /* espacio para el contenido */
    padding: .25rem .5rem 0 .5rem;
  }

  .pcard__footer {             /* fija los botones abajo */
    margin-top: auto;
    padding-top: .5rem;
  }
</style>

<!-- Fondo de la tarjeta din치mico seg칰n el estado -->
<div class="card shadow-sm p-3 mb-4 text-center pcard h-100"
     style={`background-color: ${colorEstado}`}>
  <div class="pcard__imgwrap">
    <img
      class="pcard__img"
      src={`${imagenFinal}?t=${Date.now()}`}
      alt={`Imagen del equipo de ${cliente}`}
      loading="lazy"
    />
  </div>

  <div class="pcard__body">
    <h6 class="fw-bold text-dark mt-1 mb-1" style="font-size:1.12rem;">
      {cliente}
    </h6>

    <ul class="list-unstyled mb-2 small text-secondary">
      <li><strong>ID:</strong> {id}</li>
      <li><strong>Ticket:</strong> {ticket}</li>
      <li><strong>Modelo:</strong> {maquina}</li>
      <li><strong>Estado:</strong> {estado}</li>
      <li><strong>WhatsApp:</strong> {whatsapp}</li>
    </ul>
  </div>

  <div class="pcard__footer d-flex gap-2 justify-content-center">
    <a href={onClickUrl} class="btn-ver-card px-3 py-1">Ver</a>
    <a href={onClickUrlEditar} class="btn-editar-card px-3 py-1">Editar</a>
  </div>
</div>
